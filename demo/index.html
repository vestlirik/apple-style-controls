<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Demo</title>
    <link rel="stylesheet" href="../src/styles.css">
</head>
<body>
<p>Buttons</p>
<button class="asc">Sample</button>
<button class="asc asc-icon-button asc-info-button"></button>
<button class="asc asc-icon-button asc-warning-button"></button>
<button class="asc asc-icon-button asc-plus-button"></button>
<button class="asc asc-icon-button asc-minus-button"></button>
<p>Toggle</p>
<div class="asc asc-switch">
    <input id="sample-checkbox" type="checkbox" checked>
    <label for="sample-checkbox"></label>
</div>
<p>Radio buttons</p>
<div style="width: 300px">
    <div class="asc asc-radio-button">
        <input id="milk-button" type="radio" name="group1" value="Milk">
        <label for="milk-button">Milk</label>
    </div>
    <div class="asc asc-radio-button">
        <input id="butter-button" type="radio" name="group1" checked value="Butter">
        <label for="butter-button">Butter</label>
    </div>
    <div class="asc asc-radio-button">
        <input id="cheese-button" type="radio" name="group1" value="Cheese">
        <label for="cheese-button">Cheese</label>
    </div>
</div>
<p>Edit menu</p>
<div id="asc-edit-menu" class="asc asc-edit-menu">
    <li>Cut</li>
    <li>Copy</li>
    <li>Replace...</li>
    <li>Look Up</li>
    <li>Replace...</li>
    <li>Look Up</li>
    <li>Replace...</li>
    <li>Look Up</li>
    <li>Share...</li>
</div>
<button id="show-edit-menu" class="asc">Show menu</button>
<p>Select some text for showing menu</p>
<p class="selectable-item">Lorem ipsum Lorem ipsum Lorem ipsum Lorem ipsum Lorem ipsum Lorem ipsum Lorem ipsum Lorem ipsum Lorem ipsum Lorem
    ipsum Lorem ipsum Lorem
    ipsum Lorem ipsum Lorem ipsum Lorem ipsum Lorem ipsum Lorem ipsum Lorem ipsum Lorem ipsum Lorem ipsum Lorem ipsum Lorem ipsum Lorem
    ipsum </p>

<script>
    function hideEditMenu(e) {
        var editMenu = document.getElementById('asc-edit-menu');
        if(!e || !editMenu.contains(e.target)) {
            document.getElementById('asc-edit-menu').style.display = 'none';
            removePageClickEvent();
        }
    }

    function removePageClickEvent() {
        document.getElementsByTagName('html')[0].removeEventListener('click', hideEditMenu);
    }

    function editMenuClick(e) {
        removePageClickEvent();
        var editMenu = document.getElementById('asc-edit-menu');
        editMenu.style.display = 'flex';
        var topOffset = e.target.getBoundingClientRect().top - editMenu.clientHeight - 10;
        editMenu.style.top = topOffset + "px";
        var leftOffset = e.clientX - editMenu.clientWidth / 2;
        if (leftOffset < 10) {
            leftOffset = 10;
        }
        if (leftOffset + editMenu.clientWidth > screen.availWidth) {
            leftOffset = screen.availWidth - editMenu.clientWidth - 20;
        }
        editMenu.style.left = leftOffset + "px";

        var offetForTriangle = (e.clientX || 0) - editMenu.offsetLeft - 5;// 5 is haft of width of triangle
        if (offetForTriangle < 5) {
            offetForTriangle = 5;
        } else {
            if (offetForTriangle + 10 + 14 >= editMenu.clientWidth) {
                offetForTriangle = editMenu.clientWidth - 10 - 14;
            }
        }
        var css = 'left: ' + (offetForTriangle) + 'px;';
        addStyleToHead('div.asc-edit-menu:after{' + css + '}');

        setTimeout(function () {
            document.getElementsByTagName('html')[0].addEventListener('click', hideEditMenu);
        }, 0);
    }
    hideEditMenu();
    document.getElementById('show-edit-menu').addEventListener('click', editMenuClick);
    function gText(e) {
        var t = (document.all) ? document.selection.createRange().text : document.getSelection();
        if (t.toString().length > 0) {
            editMenuClick(e);
        } else {
            hideEditMenu(e);
        }
    }

    var selectables = document.getElementsByClassName('selectable-item');
    for (var item in selectables) {
        selectables[item].onmouseup = gText;
    }

    function addStyleToHead(css) {
        var head = document.head || document.getElementsByTagName('head')[0],
            style = document.createElement('style');

        style.type = 'text/css';
        if (style.styleSheet) {
            style.styleSheet.cssText = css;
        } else {
            style.appendChild(document.createTextNode(css));
        }

        head.appendChild(style);
    }
</script>
</body>
</html>